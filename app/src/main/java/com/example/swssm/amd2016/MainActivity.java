package com.example.swssm.amd2016;

import android.app.Activity;
import android.graphics.Color;
import android.os.Bundle;
import android.support.v4.view.ViewPager;
import android.util.Log;
import android.view.View;
import android.widget.TextView;
import com.example.swssm.amd2016.PagerAdapter.PagerAdapterManager;
import com.example.swssm.amd2016.database.DbOpenHelper;

/**
 * Created by jinheon Kim on 2016-01-22.
 */
public class MainActivity extends Activity implements View.OnClickListener{

    private static final String     TAG = "MainActivity";
    public static DbOpenHelper      mDbOpenHelper;
    private TextView                tv_topMenu1;
    private TextView                tv_topMenu2;
    private TextView                tv_topMenu3;
    private ViewPager               mPager;
    private wekaClassPer wcP;
    private wekaClassSys wcS;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.top_menu);


        mDbOpenHelper = new DbOpenHelper(this);
        mDbOpenHelper.open();

        wcP = new wekaClassPer(getApplicationContext(), mDbOpenHelper);

        try {
            wcP.executeWekaTutorial();
        } catch (Exception e) {
            e.printStackTrace();
            Log.i("weka loading failed ", "weka loading failed " + e.getMessage());
        }


        setLayout();

        mPager = (ViewPager)findViewById(R.id.pager);
        mPager.setAdapter(new PagerAdapterManager(MainActivity.this, mDbOpenHelper));
        mPager.addOnPageChangeListener(new ViewPager.OnPageChangeListener () {
            @Override
            public void onPageSelected(int position) {
                switch (position) {
                    case 0:
                        tv_topMenu1.setBackgroundColor(Color.parseColor("#2F9D27"));
                        tv_topMenu2.setBackgroundColor(Color.parseColor("#86E57F"));
                        tv_topMenu3.setBackgroundColor(Color.parseColor("#86E57F"));
                        break;
                    case 1:
                        tv_topMenu2.setBackgroundColor(Color.parseColor("#2F9D27"));
                        tv_topMenu1.setBackgroundColor(Color.parseColor("#86E57F"));
                        tv_topMenu3.setBackgroundColor(Color.parseColor("#86E57F"));
                        break;
                    case 2:
                        tv_topMenu3.setBackgroundColor(Color.parseColor("#2F9D27"));
                        tv_topMenu1.setBackgroundColor(Color.parseColor("#86E57F"));
                        tv_topMenu2.setBackgroundColor(Color.parseColor("#86E57F"));
                        break;
                }
            }
            @Override
            public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels) {}
            @Override
            public void onPageScrollStateChanged(int state) {}
        });
        mPager.setCurrentItem(0);

    }




    private void setLayout(){

        tv_topMenu1 = (TextView)findViewById(R.id.tv_topMenu1);
        tv_topMenu2 = (TextView)findViewById(R.id.tv_topMenu2);
        tv_topMenu3 = (TextView)findViewById(R.id.tv_topMenu3);
        tv_topMenu1.setOnClickListener(this);
        tv_topMenu2.setOnClickListener(this);
        tv_topMenu3.setOnClickListener(this);
    }

    @Override
    public void onClick(View v) {
        switch (v.getId()) {
            case R.id.tv_topMenu1:
                mPager.setCurrentItem(0);
                break;
            case R.id.tv_topMenu2:
                mPager.setCurrentItem(1);
                break;
            case R.id.tv_topMenu3:
                mPager.setCurrentItem(2);
                break;
        }
    }

    @Override
    public void onDestroy(){
        mDbOpenHelper.close();
        super.onDestroy();
    }
}